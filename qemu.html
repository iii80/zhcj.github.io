<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv=Content-Type content="text/html; charset=utf-8">
<meta http-equiv=pragma content=no-cache>
<link href="css/bootstrap.min.css" rel="stylesheet">
<link href="css/font-awesome.min.css" rel="stylesheet">
<script src="js/jquery.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<link rel="shortcut icon" href="favicon.ico">
<link rel="bookmark" href="favicon.ico">
<title>QEMU安装使用手册</title>
</head>
<body style="margin:20px">
<p><a href="index.html">返回首页</a></p>
<h2 align=center>QEMU安装使用手册</h2>
<h3>注：网站系统为CentOS 7.6，使用systemd。</h3>
<p><b>一、安装qemu</b></p>
<pre>
wget https://download.qemu.org/qemu-4.1.0.tar.xz
tar xvf qemu-4.1.0.tar.xz
cd qemu-4.1.0
./configure --prefix=/data/kvm --interp-prefix=/data/kvm/gnemul --enable-kvm --enable-vnc --disable-bluez --target-list=i386-softmmu,x86_64-softmmu,i386-linux-user,x86_64-linux-user
make -j5
make install
</pre>
<p><b>二、安装libvirt</b></p>
<pre>
yum install yajl-devel
#emerge yajl
wget https://libvirt.org/sources/libvirt-5.7.0.tar.xz
tar xvf libvirt-5.7.0.tar.xz
cd libvirt-5.7.0
./configure --prefix=/data/kvm --without-vmware --without-vbox --without-openvz --without-esx --without-lxc --with-yajl --with-qemu
#去掉vmware/vbox/openvz/esx/lxc支持，只支持qemu
make -j5
make install
ln -s /data/kvm/bin/* /usr/local/bin/
ln -s /data/kvm/sbin/* /usr/local/bin/
cp src/libvirtd.service /lib/systemd/system/
cp src/libvirtd.socket /lib/systemd/system/
cp src/virtlogd.service /lib/systemd/system/
cp src/virtlogd.socket /lib/systemd/system/
cp src/virtlockd.service /lib/systemd/system/
cp src/virtlockd.socket /lib/systemd/system/
systemctl start libvirtd
systemctl enable libvirtd
</pre>
<p><b>三、创建虚拟机</b></p>
<pre>
mkdir /data/kvm/img
qemu-img create -f qcow2 /data/kvm/img/xp.qcow2 10G
qemu-system-i386 -m 2048 -enable-kvm /data/kvm/img/xp.qcow2 -cdrom /data/os/xp.iso
</pre>
<p>暂未完成</p>
<p><a href="index.html">返回首页</a></p>
<p align="center">版权所有 &copy; 2016-2019 清风的个人笔记 
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?6383511877c1f3152c86dffde46dd57a";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>
</p>
</body>
